<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão - MOLDART 3D (Online)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #ffffff; --bg-secondary: #f3f4f6; --bg-tertiary: #f9fafb;
            --text-primary: #1f2937; --text-secondary: #4b5563; --text-tertiary: #6b7280;
            --border-color: #e5e7eb;
            --primary-500: #6366f1; --primary-600: #4f46e5; --primary-700: #4338ca;
            --secondary-500: #10b981; --secondary-600: #059669; --secondary-700: #047857;
            --danger-500: #ef4444; --danger-600: #dc2626;
        }
        [data-theme="dark"] {
            --bg-primary: #1f2937; --bg-secondary: #111827; --bg-tertiary: #374151;
            --text-primary: #f9fafb; --text-secondary: #d1d5db; --text-tertiary: #9ca3af;
            --border-color: #374151;
        }
        [data-theme="ocean"] {
            --bg-primary: #eff6ff; --bg-secondary: #dbeafe; --bg-tertiary: #bfdbfe;
            --text-primary: #1e3a8a; --text-secondary: #1d4ed8; --text-tertiary: #1e40af;
            --border-color: #93c5fd;
            --primary-500: #3b82f6; --primary-600: #2563eb; --primary-700: #1d4ed8;
            --secondary-500: #2dd4bf; --secondary-600: #14b8a6; --secondary-700: #0d9488;
        }
        [data-theme="forest"] {
            --bg-primary: #f0fdf4; --bg-secondary: #dcfce7; --bg-tertiary: #bbf7d0;
            --text-primary: #14532d; --text-secondary: #166534; --text-tertiary: #15803d;
            --border-color: #86efac;
            --primary-500: #84cc16; --primary-600: #65a30d; --primary-700: #4d7c0f;
            --secondary-500: #22c55e; --secondary-600: #16a34a; --secondary-700: #15803d;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-secondary); color: var(--text-primary); }
        .modal-backdrop { background-color: rgba(0,0,0,0.5); z-index: 50; }
        .modal { transition: opacity 0.3s ease, transform 0.3s ease; z-index: 100; background-color: var(--bg-primary); }
        .product-card { background-color: var(--bg-primary); transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
        .tab-button.active, .category-filter-btn.active { border-color: var(--primary-500); color: var(--primary-500); background-color: var(--bg-tertiary); }
        .period-button.active { background-color: var(--primary-500); color: white; }
        .theme-button.active { box-shadow: 0 0 0 3px var(--primary-500); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary-600); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes blink { 50% { opacity: 0; } }
        .blinking-icon { animation: blink 1s linear infinite; }
        .payment-badge { padding: 2px 8px; border-radius: 9999px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; margin-left: 8px; display: inline-block; vertical-align: middle; }
        .badge-dinheiro { background-color: #d1fae5; color: #065f46; }
        .badge-pix { background-color: #cffafe; color: #0e7490; }
        .badge-credito { background-color: #dbeafe; color: #1e40af; }
        .order-status-badge { padding: 3px 10px; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
        .status-text-lg { font-size: 1.125rem; line-height: 1.75rem; font-weight: 700; text-transform: uppercase; }
        .status-text-espera { color: #92400e; }
        .status-text-producao { color: #1e40af; }
        .status-text-finalizado { color: #065f46; }
        .badge-espera { background-color: #fef3c7; color: #92400e; }
        .badge-producao { background-color: #dbeafe; color: #1e40af; }
        .badge-finalizado { background-color: #d1fae5; color: #065f46; }
        .order-card-espera { background-color: #ffebee; border-left: 4px solid #F44336; }
        .order-card-producao { background-color: #fffde7; border-left: 4px solid #FFEB3B; }
        .order-card-finalizado { background-color: #e8f5e9; border-left: 4px solid #4CAF50; }
        .calendar-day { transition: background-color 0.2s ease; }
        .calendar-day.has-order-espera { background-color: #F44336; color: white; font-weight: bold; border-radius: 50%; }
        .calendar-day.has-order-producao { background-color: #FFEB3B; color: #333; font-weight: bold; border-radius: 50%; }
        .calendar-day.has-order-finalizado { background-color: #4CAF50; color: white; font-weight: bold; border-radius: 50%; }
        .calendar-day.selected { box-shadow: 0 0 0 3px var(--primary-600); border-radius: 50%; }
        #modal-edit-produto, #modal-edit-materiaprima, #modal-edit-cliente, #modal-venda-antiga, #modal-importar-vendas, #modal-edit-categoria, #modal-edit-product-list, #modal-add-order, #modal-edit-order { z-index: 110; }
        #modal-venda-detalhes, #modal-cliente-detalhes, #modal-edit-venda, #modal-desconto { z-index: 115; }
        #modal-confirm, #modal-contas-receber { z-index: 120; }
        #modal-receber-pagamento { z-index: 125; }
        #modal-backup-reminder { z-index: 150; }
        #loading-overlay { z-index: 9999; }
        .toggle-checkbox:checked { right: 0; border-color: var(--secondary-500); background-color: white; }
        .toggle-checkbox:checked + .toggle-label { background-color: var(--secondary-500); }
        .toggle-checkbox { transition: all 0.2s ease-in-out; }
        .sidebar-item.active { background-color: var(--primary-600); color: white; }
        @media print {
            body * { visibility: hidden; }
            #receipt-modal, #receipt-modal *, #modal-venda-detalhes, #modal-venda-detalhes * { visibility: visible; }
            #receipt-modal, #modal-venda-detalhes { position: absolute; left: 0; top: 0; width: 100%; }
            .no-print { display: none; }
        }
    </style>
</head>
<body class="antialiased">

    <div id="loading-overlay" class="fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center hidden z-[9999]">
        <div class="loader"></div>
    </div>

    <div class="relative min-h-screen lg:flex">
        <nav id="sidebar" class="bg-[var(--bg-primary)] text-[var(--text-primary)] w-64 p-4 fixed inset-y-0 left-0 z-40
                                         transform -translate-x-full transition-transform duration-300
                                         lg:relative lg:translate-x-0 lg:shadow-lg">
            <div class="text-center mb-10">
                <h2 class="text-2xl font-bold text-[var(--primary-600)]">Gestão PDV</h2>
                <p class="text-sm text-[var(--text-secondary)]">Papelaria & 3D</p>
            </div>
            <ul class="space-y-2">
                <li><button data-view="dashboard-view" class="sidebar-item w-full text-left flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-[var(--primary-600)] hover:text-white transition-colors duration-200"><i class="fas fa-tachometer-alt w-5"></i> Dashboard</button></li>
                <li><button data-view="pos-view" class="sidebar-item w-full text-left flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-[var(--primary-600)] hover:text-white transition-colors duration-200"><i class="fas fa-cash-register w-5"></i> Ponto de Venda</button></li>
                <li><button data-view="schedule-view" class="sidebar-item w-full text-left flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-[var(--primary-600)] hover:text-white transition-colors duration-200"><i class="fas fa-calendar-alt w-5"></i> Agenda de Pedidos</button></li>
            </ul>
        </nav>

        <div id="sidebar-overlay" class="fixed inset-0 bg-black opacity-50 z-30 hidden lg:hidden"></div>

        <main class="flex-1 p-4 sm:p-6 lg:p-8 bg-[var(--bg-secondary)] overflow-y-auto">
            <header class="flex items-center justify-between mb-6">
                <button id="hamburger-btn" class="text-2xl text-[var(--text-secondary)] lg:hidden">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="lg:hidden"></div>
                
                <button id="open-settings-modal-btn" class="text-2xl text-[var(--text-secondary)] hover:text-[var(--primary-600)] transition-colors duration-200">
                    <i class="fas fa-cog"></i>
                </button>
            </header>

            <div id="dashboard-view" class="">
                <header class="mb-6">
                    <h1 class="text-3xl font-bold">Dashboard</h1>
                    <p class="text-[var(--text-secondary)]">Resumo do seu negócio em tempo real.</p>
                </header>
                
                <div id="overdue-orders-alert-container" class="mb-6 space-y-4">
                    <!-- Alertas de pedidos em atraso serão inseridos aqui -->
                </div>

                <div id="dashboard-alerts-container" class="mb-6 space-y-4">
                    <!-- Alertas de entrega do dia serão inseridos aqui -->
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6 mb-8">
                    <div class="bg-[var(--bg-primary)] p-6 rounded-lg shadow-md flex items-center gap-4">
                        <div class="bg-green-100 p-3 rounded-full"><i class="fas fa-dollar-sign fa-2x text-green-600"></i></div>
                        <div>
                            <p class="text-sm text-[var(--text-secondary)]">Vendas Hoje</p>
                            <p id="kpi-sales-today" class="text-2xl font-bold">R$ 0,00</p>
                        </div>
                    </div>
                    <div class="bg-[var(--bg-primary)] p-6 rounded-lg shadow-md flex items-center gap-4">
                        <div class="bg-blue-100 p-3 rounded-full"><i class="fas fa-chart-line fa-2x text-blue-600"></i></div>
                        <div>
                            <p class="text-sm text-[var(--text-secondary)]">Lucro Hoje</p>
                            <p id="kpi-profit-today" class="text-2xl font-bold">R$ 0,00</p>
                        </div>
                    </div>
                    <div class="bg-[var(--bg-primary)] p-6 rounded-lg shadow-md flex items-center gap-4">
                        <div class="bg-purple-100 p-3 rounded-full"><i class="fas fa-receipt fa-2x text-purple-600"></i></div>
                        <div>
                            <p class="text-sm text-[var(--text-secondary)]">Ticket Médio (Hoje)</p>
                            <p id="kpi-avg-ticket" class="text-2xl font-bold">R$ 0,00</p>
                        </div>
                    </div>
                    <div id="kpi-card-unpaid" class="bg-[var(--bg-primary)] p-6 rounded-lg shadow-md flex items-center gap-4 cursor-pointer hover:shadow-xl transition-shadow">
                        <div class="bg-red-100 p-3 rounded-full"><i class="fas fa-file-invoice-dollar fa-2x text-red-600"></i></div>
                        <div>
                            <p class="text-sm text-[var(--text-secondary)]">Contas a Receber</p>
                            <p id="kpi-unpaid" class="text-2xl font-bold">R$ 0,00</p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
                    <div class="xl:col-span-1 bg-[var(--bg-primary)] p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4">Ações Rápidas</h3>
                        <div class="space-y-3">
                            <button data-view="pos-view" class="quick-action-btn w-full text-left bg-[var(--primary-600)] text-white px-4 py-3 rounded-lg shadow hover:bg-[var(--primary-700)] transition flex items-center gap-3"><i class="fas fa-cash-register w-5"></i> Nova Venda</button>
                            <button data-modal-id="modal-produto" class="open-modal-btn w-full text-left bg-[var(--secondary-600)] text-white px-4 py-3 rounded-lg shadow hover:bg-[var(--secondary-700)] transition flex items-center gap-3"><i class="fas fa-plus-circle w-5"></i> Adicionar Produto</button>
                            <button data-modal-id="modal-contas-receber" class="open-modal-btn w-full text-left bg-orange-500 text-white px-4 py-3 rounded-lg shadow hover:bg-orange-600 transition flex items-center gap-3"><i class="fas fa-file-invoice-dollar w-5"></i> Contas a Receber</button>
                            <button data-modal-id="modal-relatorios" class="open-modal-btn w-full text-left bg-gray-700 text-white px-4 py-3 rounded-lg shadow hover:bg-gray-800 transition flex items-center gap-3"><i class="fas fa-chart-bar w-5"></i> Ver Relatórios</button>
                        </div>
                    </div>
                    <div class="xl:col-span-2 bg-[var(--bg-primary)] p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4">Atividade Recente</h3>
                        <div id="recent-transactions-list" class="space-y-2">
                            <p class="text-center text-gray-500 mt-4">Nenhuma atividade recente.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="pos-view" class="hidden">
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                    <div class="lg:col-span-3">
                        <header class="mb-4">
                            <h1 class="text-2xl lg:text-3xl font-bold">Ponto de Venda</h1>
                            <p class="text-[var(--text-secondary)]">Selecione produtos para adicionar ao caixa.</p>
                        </header>
                        
                        <div class="flex flex-wrap gap-2 sm:gap-3 mb-4">
                            <button data-modal-id="modal-produto" class="open-modal-btn bg-[var(--primary-600)] text-white px-3 py-2 text-sm sm:px-4 rounded-lg shadow hover:bg-[var(--primary-700)] transition flex items-center gap-2"><i class="fas fa-plus-circle"></i> Novo Produto</button>
                            <button data-modal-id="modal-categorias" class="open-modal-btn bg-teal-600 text-white px-3 py-2 text-sm sm:px-4 rounded-lg shadow hover:bg-teal-700 transition flex items-center gap-2"><i class="fas fa-tags"></i> Gerir Categorias</button>
                            <button data-modal-id="modal-materiaprima" class="open-modal-btn bg-[var(--secondary-600)] text-white px-3 py-2 text-sm sm:px-4 rounded-lg shadow hover:bg-[var(--secondary-700)] transition flex items-center gap-2"><i class="fas fa-boxes-stacked"></i> Estoque</button>
                            <button data-modal-id="modal-clientes" class="open-modal-btn bg-purple-600 text-white px-3 py-2 text-sm sm:px-4 rounded-lg shadow hover:bg-purple-700 transition flex items-center gap-2"><i class="fas fa-users"></i> Clientes</button>
                            <button data-modal-id="modal-contas-receber" class="open-modal-btn bg-orange-500 text-white px-3 py-2 text-sm sm:px-4 rounded-lg shadow hover:bg-orange-600 transition flex items-center gap-2"><i class="fas fa-file-invoice-dollar"></i> A Receber</button>
                        </div>
                        
                        <div class="mb-4 relative">
                            <input type="text" id="search-barcode" placeholder="BIPAR CÓDIGO DE BARRAS AQUI..." class="w-full p-3 pl-10 border-2 border-dashed border-[var(--primary-500)] rounded-lg bg-[var(--bg-tertiary)] text-center font-semibold">
                            <i class="fas fa-barcode absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-tertiary)] text-2xl"></i>
                        </div>
                        
                        <div class="mb-4 relative">
                            <input type="text" id="search-product" placeholder="Ou procurar produto por nome..." class="w-full p-2 pl-10 border rounded-lg bg-[var(--bg-primary)] border-[var(--border-color)]">
                            <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-tertiary)]"></i>
                        </div>
                        
                        <div id="category-filters" class="mb-4 flex flex-wrap gap-2"></div>
                        
                        <div id="product-grid" class="grid grid-cols-2 md:grid-cols-3 gap-4"></div>
                    </div>

                    <div class="lg:col-span-2">
                        <div class="lg:sticky top-6">
                            <div class="bg-[var(--bg-primary)] shadow-lg rounded-lg flex flex-col p-4 sm:p-6">
                                <div class="flex-grow">
                                    <h2 class="text-xl lg:text-2xl font-bold mb-4 border-b pb-2 border-[var(--border-color)]">Caixa</h2>
                                    <div class="mb-4">
                                        <label for="customer-select" class="block text-sm font-medium text-[var(--text-secondary)] mb-1">Associar Cliente (Obrigatório)</label>
                                        <select id="customer-select" class="w-full border rounded p-2 bg-[var(--bg-secondary)]"></select>
                                    </div>
                                    <div id="customer-info-summary" class="hidden mt-2 p-3 bg-[var(--bg-tertiary)] rounded-lg text-sm border border-[var(--border-color)] space-y-1"></div>
                                    <div id="cart-items" class="space-y-3 mt-4 max-h-[40vh] overflow-y-auto"></div>
                                </div>
                                <div class="border-t border-[var(--border-color)] pt-4 mt-4 space-y-3 flex-shrink-0">
                                    <div class="flex justify-between font-medium text-lg"><span>Subtotal</span><span id="subtotal">R$ 0,00</span></div>
                                    <div class="flex justify-between font-medium text-lg text-red-500"><span>Descontos</span><span id="discounts-total">R$ 0,00</span></div>
                                    <div class="flex justify-between font-bold text-xl lg:text-2xl text-[var(--primary-600)]"><span>TOTAL</span><span id="total">R$ 0,00</span></div>
                                    <button id="apply-general-discount-btn" class="w-full text-[var(--primary-600)] border-2 border-[var(--primary-600)] py-2 rounded-lg hover:bg-[var(--primary-600)] hover:text-white transition-colors duration-200"><i class="fas fa-tags"></i> Aplicar Desconto Geral</button>
                                    <button id="checkout-button" class="w-full bg-[var(--primary-600)] text-white py-3 rounded-lg text-lg font-bold hover:bg-[var(--primary-700)]" disabled><i class="fas fa-check-circle"></i> Finalizar Venda</button>
                                    <button id="clear-cart-button" class="w-full bg-[var(--danger-500)] text-white py-2 rounded-lg hover:bg-[var(--danger-600)]"><i class="fas fa-times-circle"></i> Cancelar Venda</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="schedule-view" class="hidden">
                <header class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6">
                    <div>
                        <h1 class="text-3xl font-bold">Agenda de Pedidos</h1>
                        <p class="text-[var(--text-secondary)]">Gerencie orçamentos e datas de entrega.</p>
                    </div>
                    <button id="open-add-order-modal-btn" class="mt-4 sm:mt-0 bg-[var(--primary-600)] text-white px-4 py-2 rounded-lg shadow hover:bg-[var(--primary-700)] transition flex items-center gap-2">
                        <i class="fas fa-plus-circle"></i> Novo Pedido/Orçamento
                    </button>
                </header>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-1 bg-[var(--bg-primary)] p-4 sm:p-6 rounded-lg shadow-md">
                        <div id="calendar-header" class="flex items-center justify-between mb-4">
                            <button id="prev-month-btn" class="px-3 py-1 rounded-md hover:bg-[var(--bg-secondary)]"><i class="fas fa-chevron-left"></i></button>
                            <h3 id="calendar-month-year" class="text-lg font-bold text-center"></h3>
                            <button id="next-month-btn" class="px-3 py-1 rounded-md hover:bg-[var(--bg-secondary)]"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div id="calendar-grid" class="grid grid-cols-7 gap-2 text-center"></div>
                    </div>

                    <div class="lg:col-span-2 bg-[var(--bg-primary)] p-4 sm:p-6 rounded-lg shadow-md">
                        <div class="flex items-center justify-between mb-4">
                             <h3 class="text-xl font-bold">Pedidos Agendados</h3>
                             <button id="show-all-orders-btn" class="text-sm text-[var(--primary-600)] hover:underline">Mostrar Todos</button>
                        </div>
                        <div class="mb-4 relative">
                            <input type="text" id="order-search-input" list="customer-suggestions" placeholder="Buscar por nome do cliente..." class="w-full p-2 pl-10 border rounded-lg bg-[var(--bg-secondary)] border-[var(--border-color)]">
                            <datalist id="customer-suggestions"></datalist>
                            <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-tertiary)]"></i>
                        </div>
                        <div id="order-list-container" class="space-y-3 max-h-[60vh] overflow-y-auto">
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <div id="modal-relatorios" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-[95%] max-w-6xl h-[90vh] flex flex-col rounded-lg shadow-xl p-4 sm:p-6 bg-[var(--bg-primary)]">
            <div class="flex justify-between items-center border-b pb-3 mb-4 flex-shrink-0">
                <h3 class="text-xl sm:text-2xl font-bold">Relatórios</h3>
                <button class="close-modal-btn text-2xl">&times;</button>
            </div>
            
            <div class="flex-grow overflow-y-auto pr-2">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between border-b mb-4 pb-2 gap-2">
                    <div id="report-period-buttons" class="flex flex-wrap gap-2">
                        <button class="period-button text-xs sm:text-sm py-2 px-3 rounded-md" data-period="daily">Diário</button>
                        <button class="period-button text-xs sm:text-sm py-2 px-3 rounded-md" data-period="weekly">Semanal</button>
                        <button class="period-button text-xs sm:text-sm py-2 px-3 rounded-md" data-period="monthly">Mensal</button>
                        <button class="period-button text-xs sm:text-sm py-2 px-3 rounded-md" data-period="annual">Anual</button>
                    </div>
                    <div id="month-year-selector" class="hidden flex items-center gap-2">
                         <select id="report-month-select" class="border rounded-md p-2 bg-[var(--bg-tertiary)] text-sm"></select>
                         <select id="report-year-select" class="border rounded-md p-2 bg-[var(--bg-tertiary)] text-sm"></select>
                    </div>
                </div>

                <div class="mb-4 border-b flex flex-wrap">
                    <button class="tab-button text-sm sm:text-base py-2 px-4 border-b-2" data-tab="vendas">Vendas</button>
                    <button class="tab-button text-sm sm:text-base py-2 px-4 border-b-2" data-tab="recebimentos">Recebimentos</button>
                    <button class="tab-button text-sm sm:text-base py-2 px-4 border-b-2" data-tab="vendas-cliente">Por Cliente</button>
                    <button class="tab-button text-sm sm:text-base py-2 px-4 border-b-2" data-tab="desempenho-produtos">Produtos</button>
                    <button class="tab-button text-sm sm:text-base py-2 px-4 border-b-2" data-tab="vendas-produto">Vendas por Produto</button>
                </div>

                <div id="tab-vendas" class="tab-content space-y-6">
                    <div id="sales-summary" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 text-center"></div>
                    <div class="relative h-64 sm:h-96 w-full mb-4">
                        <canvas id="salesChart"></canvas>
                    </div>
                    <div class="overflow-x-auto">
                        <div id="transactions-list" class="min-w-[600px]"></div>
                    </div>
                    <div class="overflow-x-auto">
                        <div id="annual-summary-table" class="min-w-[600px] hidden"></div>
                    </div>
                </div>

                <div id="tab-recebimentos" class="tab-content hidden space-y-4">
                    <!-- Conteúdo do Relatório de Recebimentos será inserido aqui pelo JS -->
                </div>

                <div id="tab-vendas-cliente" class="tab-content hidden overflow-x-auto">
                    <div id="sales-by-customer-container" class="min-w-[600px]"></div>
                </div>

                <div id="tab-desempenho-produtos" class="tab-content hidden overflow-x-auto">
                       <div class="min-w-[600px]"></div>
                </div>
                
                <div id="tab-vendas-produto" class="tab-content hidden">
                    <h3 class="text-lg font-semibold mb-4">Relatório Detalhado de Vendas por Produto</h3>
                    <div class="mb-4">
                        <label for="sales-report-product-select" class="block text-sm font-medium mb-1">Selecione um Produto</label>
                        <select id="sales-report-product-select" class="w-full max-w-md border rounded p-2 bg-[var(--bg-tertiary)]"></select>
                    </div>
                       <div class="mb-4 relative">
                        <input type="text" id="sales-report-customer-search" placeholder="Procurar por cliente..." class="w-full max-w-md p-2 pl-10 border rounded-lg bg-[var(--bg-primary)] border-[var(--border-color)]" disabled>
                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-tertiary)]"></i>
                    </div>
                    <div id="sales-report-details-container" class="mt-4">
                        <p class="text-center text-gray-500">Selecione um produto para ver os detalhes das vendas.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-produto" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-lg rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Adicionar Novo Produto</h3>
            <form id="add-product-form" class="space-y-4">
                <input type="text" name="productName" placeholder="Nome do Produto" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                <div class="grid grid-cols-2 gap-4">
                    <input type="number" name="productPrice" placeholder="Preço (R$)" step="0.01" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                    <input type="number" name="productCost" placeholder="Custo (R$)" step="0.01" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                </div>
                <input type="text" name="productBarcode" placeholder="Código de Barras (Opcional)" class="w-full border rounded p-2 bg-[var(--bg-secondary)]">
                <div>
                    <label for="add-product-category" class="block text-sm font-medium">Categoria</label>
                    <select id="add-product-category" name="productCategory" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]"></select>
                </div>
                <div class="flex justify-end gap-3 mt-4">
                    <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                    <button type="submit" class="px-4 py-2 rounded bg-[var(--primary-600)] text-white">Salvar Produto</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-edit-produto" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-lg rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Editar Produto</h3>
            <form id="edit-product-form" class="space-y-4">
                <input type="hidden" name="productId">
                <input type="text" name="productName" placeholder="Nome do Produto" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                <div class="grid grid-cols-2 gap-4">
                    <input type="number" name="productPrice" placeholder="Preço (R$)" step="0.01" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                    <input type="number" name="productCost" placeholder="Custo (R$)" step="0.01" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                </div>
                <input type="text" name="productBarcode" placeholder="Código de Barras (Opcional)" class="w-full border rounded p-2 bg-[var(--bg-secondary)]">
                <div>
                    <label for="edit-product-category" class="block text-sm font-medium">Categoria</label>
                    <select id="edit-product-category" name="editProductCategory" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]"></select>
                </div>
                <div class="flex justify-between gap-3 mt-4">
                    <button type="button" id="delete-product-btn" class="px-4 py-2 rounded bg-[var(--danger-500)] text-white">Excluir</button>
                    <div>
                        <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                        <button type="submit" class="px-4 py-2 rounded bg-[var(--primary-600)] text-white">Salvar Alterações</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-categorias" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-md rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Gerenciar Categorias</h3>
            <div id="categories-list" class="space-y-2 mb-4 max-h-60 overflow-y-auto"></div>
            <form id="add-category-form" class="flex gap-2 border-t pt-4">
                <input type="text" name="categoryName" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" placeholder="Nome da nova categoria" required>
                <button type="submit" class="bg-[var(--primary-600)] text-white px-4 py-2 rounded">Adicionar</button>
            </form>
            <button type="button" class="close-modal-btn mt-4 w-full px-4 py-2 rounded bg-gray-300 text-gray-800">Fechar</button>
        </div>
    </div>
    <div id="modal-edit-categoria" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-md rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Editar Categoria</h3>
            <form id="edit-category-form" class="space-y-3">
                <input type="hidden" name="categoryId">
                <input type="text" name="categoryName" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                <div class="flex justify-end gap-3 mt-4">
                    <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                    <button type="submit" class="px-4 py-2 rounded bg-[var(--primary-600)] text-white">Salvar</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-materiaprima" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-4xl rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Gerenciar Estoque de Insumos</h3>
            <div id="raw-materials-list" class="max-h-80 overflow-y-auto"></div>
            <form id="add-raw-material-form" class="mt-4 border-t pt-4 space-y-3">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <input type="text" name="rawMaterialName" placeholder="Nome do Insumo" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                    <input type="text" name="rawMaterialSupplier" placeholder="Fornecedor" class="w-full border rounded p-2 bg-[var(--bg-secondary)]">
                    <input type="date" name="rawMaterialReceiptDate" class="w-full border rounded p-2 bg-[var(--bg-secondary)]">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                     <input type="number" name="rawMaterialStock" placeholder="Quantidade" step="any" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                     <input type="text" name="rawMaterialUnit" placeholder="Unidade (ex: kg, un, m)" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                     <input type="number" name="rawMaterialTotalCost" placeholder="Custo Total (R$)" step="0.01" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                </div>
                <div class="flex justify-end gap-3">
                     <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Fechar</button>
                     <button type="submit" class="px-4 py-2 rounded bg-[var(--primary-600)] text-white">Adicionar ao Estoque</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-edit-materiaprima" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-4xl rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
             <h3 class="text-xl font-bold mb-4">Editar Item de Estoque</h3>
             <form id="edit-raw-material-form" class="space-y-3">
                <input type="hidden" name="rawMaterialId">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <input type="text" name="rawMaterialName" placeholder="Nome do Insumo" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                    <input type="text" name="rawMaterialSupplier" placeholder="Fornecedor" class="w-full border rounded p-2 bg-[var(--bg-secondary)]">
                    <input type="date" name="rawMaterialReceiptDate" class="w-full border rounded p-2 bg-[var(--bg-secondary)]">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                     <input type="number" name="rawMaterialStock" placeholder="Quantidade" step="any" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                     <input type="text" name="rawMaterialUnit" placeholder="Unidade (ex: kg, un, m)" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                     <input type="number" name="rawMaterialTotalCost" placeholder="Custo Total (R$)" step="0.01" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                </div>
                <div class="flex justify-end gap-3">
                     <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                     <button type="submit" class="px-4 py-2 rounded bg-[var(--primary-600)] text-white">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-clientes" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-2xl rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <div class="flex justify-between items-center border-b pb-3">
                <h3 class="text-xl font-bold">Gerenciar Clientes</h3>
                <button class="close-modal-btn text-2xl">&times;</button>
            </div>
            <div class="mt-4">
                <div id="customers-list" class="space-y-2 max-h-64 overflow-y-auto"></div>
            </div>
            <div class="mt-6 border-t pt-4">
                <h4 class="font-semibold mb-2">Adicionar Novo Cliente</h4>
                <form id="add-customer-form" class="flex gap-2">
                    <input type="text" name="customerName" placeholder="Nome do Cliente" class="flex-grow border rounded p-2 bg-[var(--bg-secondary)]" required>
                    <input type="text" name="customerContact" placeholder="Contato (Telefone/Email)" class="flex-grow border rounded p-2 bg-[var(--bg-secondary)]">
                    <button type="submit" class="bg-[var(--primary-600)] text-white px-4 py-2 rounded">Adicionar</button>
                </form>
            </div>
        </div>
    </div>
    <div id="modal-edit-cliente" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-lg rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Editar Cliente</h3>
            <form id="edit-customer-form" class="space-y-3">
                <input type="hidden" name="customerId">
                <input type="text" name="customerName" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required>
                <input type="text" name="customerContact" class="w-full border rounded p-2 bg-[var(--bg-secondary)]">
                <div class="flex justify-end gap-3 mt-4">
                    <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                    <button type="submit" class="px-4 py-2 rounded bg-[var(--primary-600)] text-white">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-settings" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-2xl rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Configurações</h3>
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold">Tema Visual</h4>
                    <div id="theme-selector" class="flex gap-3 mt-2">
                        <button class="theme-button w-10 h-10 rounded-full bg-gray-200" data-theme="light"></button>
                        <button class="theme-button w-10 h-10 rounded-full bg-gray-800" data-theme="dark"></button>
                        <button class="theme-button w-10 h-10 rounded-full bg-blue-200" data-theme="ocean"></button>
                        <button class="theme-button w-10 h-10 rounded-full bg-green-200" data-theme="forest"></button>
                    </div>
                </div>
                <div class="border-t pt-4">
                       <h4 class="font-semibold">Backup e Restauração</h4>
                       <div class="flex gap-3 mt-2">
                           <button id="export-data-btn" class="px-4 py-2 bg-green-600 text-white rounded">Exportar Backup (JSON)</button>
                           <label class="px-4 py-2 bg-blue-600 text-white rounded cursor-pointer">
                               Importar Backup (JSON)
                               <input type="file" id="import-file-input" class="hidden" accept=".json">
                           </label>
                       </div>
                </div>
                <div class="border-t pt-4">
                       <h4 class="font-semibold text-[var(--danger-600)]">Área de Risco</h4>
                       <button id="reset-system-btn" class="mt-2 px-4 py-2 bg-[var(--danger-500)] text-white rounded">Zerar Todo o Sistema</button>
                </div>
            </div>
             <div class="flex justify-end mt-6">
                <button class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Fechar</button>
            </div>
        </div>
    </div>
    <div id="modal-confirm" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-sm rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 id="confirm-title" class="text-xl font-bold mb-2">Título</h3>
            <p id="confirm-message" class="mb-6">Mensagem</p>
            <div class="flex justify-end gap-3">
                <button id="confirm-cancel-btn" class="px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                <button id="confirm-confirm-btn" class="px-4 py-2 rounded bg-[var(--danger-500)] text-white">Confirmar</button>
            </div>
        </div>
    </div>
    <div id="receipt-modal" class="fixed inset-0 z-50 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-sm rounded-lg shadow-xl p-6 bg-white text-black">
            <h3 class="text-xl font-bold text-center mb-4">Recibo</h3>
            <div id="receipt-details" class="text-sm space-y-1"></div>
            <p id="receipt-total" class="text-lg font-bold text-center my-4"></p>
            <p id="receipt-date" class="text-xs text-center text-gray-600"></p>
            <div class="flex justify-around mt-6 no-print">
                <button id="print-receipt-btn" class="px-4 py-2 bg-blue-600 text-white rounded">Imprimir</button>
                <button class="close-modal-btn px-4 py-2 bg-gray-300 text-gray-800 rounded">Fechar</button>
            </div>
        </div>
    </div>
    <div id="modal-payment" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
         <div class="modal w-full max-w-md rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-2">Finalizar Venda</h3>
            <p class="text-center text-4xl font-bold my-4" id="payment-total">R$ 0,00</p>
            <form id="payment-form" class="space-y-4">
                <div>
                    <label for="payment-method">Forma de Pagamento</label>
                    <select id="payment-method" name="paymentMethod" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                        <option>Dinheiro</option>
                        <option>Pix</option>
                        <option>Cartão de Crédito</option>
                    </select>
                </div>
                <div id="installments-group" class="hidden">
                    <label for="payment-installments">Parcelas</label>
                    <input type="number" id="payment-installments" name="paymentInstallments" value="1" min="1" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                </div>
                <div id="amount-paid-group">
                     <label for="payment-amount-paid">Valor Recebido (R$)</label>
                     <input type="number" id="payment-amount-paid" name="paymentAmount" step="0.01" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                </div>
                <div class="text-lg font-semibold flex justify-between">
                    <span>Troco:</span>
                    <span id="payment-change">R$ 0,00</span>
                </div>
                 <div class="flex items-center justify-between border-t pt-4">
                    <label for="retroactive-sale-toggle">É uma venda antiga?</label>
                    <input type="checkbox" id="retroactive-sale-toggle" name="retroactiveSale">
                </div>
                <div id="retroactive-date-group" class="hidden">
                    <label for="payment-retroactive-date">Data da Venda</label>
                    <input type="datetime-local" id="payment-retroactive-date" name="retroactiveDate" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                </div>
                <div class="flex flex-col gap-2 mt-4">
                    <button type="submit" class="w-full px-4 py-3 rounded bg-green-600 text-white font-bold">Confirmar Pagamento</button>
                    <button type="button" id="process-unpaid-sale-btn" class="w-full px-4 py-2 rounded bg-orange-500 text-white">Salvar como Não Pago</button>
                    <button type="button" class="close-modal-btn w-full px-4 py-2 rounded bg-gray-300 text-gray-800">Voltar</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-contas-receber" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-lg rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Contas a Receber</h3>
            <div id="unpaid-sales-list" class="max-h-96 overflow-y-auto"></div>
            <div class="flex justify-end mt-4">
                 <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Fechar</button>
            </div>
        </div>
    </div>
    <div id="modal-receber-pagamento" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-md rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-2">Receber Pagamento</h3>
            <p class="text-center text-3xl font-bold my-4" id="receive-payment-total">R$ 0,00</p>
               <form id="receive-payment-form" class="space-y-4">
                <input type="hidden" name="transactionId">
                <div>
                    <label for="receive-payment-method">Forma de Pagamento</label>
                    <select id="receive-payment-method" name="paymentMethod" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                        <option>Dinheiro</option>
                        <option>Pix</option>
                        <option>Cartão de Crédito</option>
                    </select>
                </div>
                <div id="receive-installments-group" class="hidden">
                    <label for="receive-payment-installments">Parcelas</label>
                    <input type="number" id="receive-payment-installments" name="paymentInstallments" value="1" min="1" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                </div>
                <div class="flex justify-end gap-3 mt-4">
                    <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                    <button type="submit" class="px-4 py-2 rounded bg-green-600 text-white">Confirmar Recebimento</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-venda-detalhes" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-[95%] max-w-md rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Detalhes da Venda</h3>
            
            <div id="sale-details-content" class="space-y-2">
            </div>

            <div class="flex justify-end mt-4 no-print">
                <button id="print-details-btn" class="px-4 py-2 rounded bg-blue-600 text-white mr-2">Imprimir</button>
                <button class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Fechar</button>
            </div>
        </div>
    </div>
    <div id="modal-cliente-detalhes" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-4xl h-[80vh] flex flex-col rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Histórico de <span id="details-customer-name"></span></h3>
            <div id="details-customer-sales-list" class="flex-grow overflow-y-auto"></div>
               <div class="flex justify-end mt-4">
                <button class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Fechar</button>
            </div>
        </div>
    </div>
    <div id="modal-edit-venda" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-md rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-2">Editar Venda</h3>
            <p class="text-center text-3xl font-bold my-4" id="edit-sale-total">R$ 0,00</p>
               <form id="edit-sale-form" class="space-y-4">
                <input type="hidden" name="transactionId">
                <div>
                    <label>Status</label>
                    <select name="saleStatus" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                        <option value="Pago">Pago</option>
                        <option value="Não Pago">Não Pago</option>
                    </select>
                </div>
                 <div>
                    <label for="edit-sale-method">Forma de Pagamento</label>
                    <select id="edit-sale-method" name="paymentMethod" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                        <option>A Prazo</option>
                        <option>Dinheiro</option>
                        <option>Pix</option>
                        <option>Cartão de Crédito</option>
                    </select>
                </div>
                <div id="edit-installments-group" class="hidden">
                    <label for="edit-payment-installments">Parcelas</label>
                    <input type="number" id="edit-payment-installments" name="paymentInstallments" value="1" min="1" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                </div>
                <div class="flex justify-end gap-3 mt-4">
                    <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                    <button type="submit" class="px-4 py-2 rounded bg-green-600 text-white">Salvar Alterações</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-desconto" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
         <div class="modal w-full max-w-md rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 id="discount-modal-title" class="text-xl font-bold mb-4">Aplicar Desconto</h3>
            <form id="discount-form" class="space-y-4">
                <input type="hidden" name="itemIndex">
                <div>
                    <label>Tipo de Desconto</label>
                    <select name="discountType" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                        <option value="fixed">Valor Fixo (R$)</option>
                        <option value="percentage">Porcentagem (%)</option>
                    </select>
                </div>
                <div>
                    <label>Valor</label>
                    <input type="number" name="discountValue" step="0.01" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]">
                </div>
                <div class="flex justify-end gap-3 mt-4">
                    <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                    <button type="submit" class="px-4 py-2 rounded bg-green-600 text-white">Aplicar Desconto</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modal-importar-vendas" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-lg rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Importar Vendas de CSV</h3>
            <form id="import-sales-form">
                <input type="file" id="csv-file-input" accept=".csv">
                <button type="submit">Importar</button>
            </form>
            <div id="import-log" class="mt-4 text-sm max-h-40 overflow-y-auto"></div>
        </div>
    </div>
    
    <div id="modal-add-order" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-lg rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Adicionar Novo Pedido</h3>
            <form id="add-order-form" class="space-y-4">
                <div>
                    <label for="order-customer-select" class="block text-sm font-medium">Cliente</label>
                    <div class="flex items-center gap-2 mt-1">
                        <select id="order-customer-select" name="orderCustomer" class="w-full border rounded p-2 bg-[var(--bg-secondary)]" required></select>
                        <button type="button" id="add-customer-from-order-btn" class="flex-shrink-0 px-3 py-2 bg-[var(--secondary-600)] text-white rounded hover:bg-[var(--secondary-700)] transition-colors" title="Adicionar Novo Cliente">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
                 <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="add-order-order-date" class="block text-sm font-medium">Data do Pedido</label>
                        <input type="date" id="add-order-order-date" name="orderOrderDate" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]" required>
                    </div>
                    <div>
                        <label for="add-order-delivery-date" class="block text-sm font-medium">Data de Entrega</label>
                        <input type="date" id="add-order-delivery-date" name="orderDeliveryDate" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]" required>
                    </div>
                </div>
                <div>
                    <label for="order-description" class="block text-sm font-medium">Descrição do Pedido</label>
                    <textarea name="orderDescription" rows="3" placeholder="Ex: 50 convites, 1 topo de bolo..." class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]" required></textarea>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div id="add-order-value-wrapper" class="hidden">
                         <label for="add-order-value" class="block text-sm font-medium">Valor do Orçamento (R$)</label>
                         <input type="number" id="add-order-value" name="orderValue" step="0.01" class="w-full border rounded p-2 bg-[var(--bg-secondary)] mt-1">
                    </div>
                    <div>
                        <label for="add-order-status" class="block text-sm font-medium">Status</label>
                        <select id="add-order-status" name="orderStatus" class="w-full border rounded p-2 bg-[var(--bg-secondary)] mt-1">
                            <option value="em espera">Em Espera</option>
                            <option value="em producao">Em Produção</option>
                            <option value="finalizado">Finalizado</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end gap-3 mt-4">
                    <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                    <button type="submit" class="px-4 py-2 rounded bg-[var(--primary-600)] text-white">Salvar Pedido</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-edit-order" class="fixed inset-0 hidden items-center justify-center modal-backdrop">
        <div class="modal w-full max-w-lg rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Editar Pedido</h3>
            <form id="edit-order-form" class="space-y-4">
                <input type="hidden" name="orderId">
                <div>
                    <label class="block text-sm font-medium">Cliente</label>
                    <p id="edit-order-customer-name" class="mt-1 font-semibold"></p>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="edit-order-order-date" class="block text-sm font-medium">Data do Pedido</label>
                        <input type="date" id="edit-order-order-date" name="orderOrderDate" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]" required>
                    </div>
                    <div>
                        <label for="edit-order-delivery-date" class="block text-sm font-medium">Data de Entrega</label>
                        <input type="date" id="edit-order-delivery-date" name="orderDeliveryDate" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]" required>
                    </div>
                </div>
                <div>
                    <label for="edit-order-description" class="block text-sm font-medium">Descrição do Pedido</label>
                    <textarea id="edit-order-description" name="orderDescription" rows="3" class="w-full border rounded p-2 mt-1 bg-[var(--bg-secondary)]" required></textarea>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div id="edit-order-value-wrapper" class="hidden">
                        <label for="edit-order-value" class="block text-sm font-medium">Valor do Orçamento (R$)</label>
                        <input type="number" id="edit-order-value" name="orderValue" step="0.01" class="w-full border rounded p-2 bg-[var(--bg-secondary)] mt-1">
                    </div>
                    <div>
                        <label for="edit-order-status" class="block text-sm font-medium">Status</label>
                        <select id="edit-order-status" name="orderStatus" class="w-full border rounded p-2 bg-[var(--bg-secondary)] mt-1">
                            <option value="em espera">Em Espera</option>
                            <option value="em producao">Em Produção</option>
                            <option value="finalizado">Finalizado</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-between gap-3 mt-4">
                    <button type="button" id="delete-order-btn" class="px-4 py-2 rounded bg-[var(--danger-500)] text-white">Excluir</button>
                    <div>
                         <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Cancelar</button>
                         <button type="submit" class="px-4 py-2 rounded bg-[var(--primary-600)] text-white">Salvar Alterações</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <div id="modal-backup-reminder" class="fixed inset-0 hidden items-center justify-center modal-backdrop z-[150]">
        <div class="modal w-full max-w-md rounded-lg shadow-xl p-6 bg-[var(--bg-primary)]">
            <h3 class="text-xl font-bold mb-4">Lembrete de Backup</h3>
            <p class="text-[var(--text-secondary)] mb-6">
                Já faz um tempo desde o seu último backup. Recomendamos salvar uma cópia de segurança dos seus dados agora para evitar perdas.
            </p>
            <div class="flex justify-end gap-3">
                <button type="button" class="close-modal-btn px-4 py-2 rounded bg-gray-300 text-gray-800">Lembrar Mais Tarde</button>
                <button type="button" id="execute-backup-btn" class="px-4 py-2 rounded bg-[var(--primary-600)] text-white">Fazer Backup Agora</button>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed bottom-5 right-5 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg opacity-0 translate-y-10 transition-all duration-300 z-[200]">
        <span>Mensagem aqui</span>
    </div>

<script src="script.js"></script>
</body>
</html>

